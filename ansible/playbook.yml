---
- name: Set up container environment
  hosts: webserver
  become: true
  gather_facts: false  # Désactivation de la collecte automatique
  vars:
    ansible_python_interpreter: /usr/bin/python3  # Spécifier l'utilisation de Python 3

  roles:
    - common
    - docker
    - keycloak
    - webserver

  tasks:
    - name: Ensure python3-apt is installed
      apt:
        name: python3-apt
        state: present
      become: true

    - name: Collect Ansible facts manually
      ansible.builtin.setup:
        gather_subset:
          - all
